#!/bin/bash

# Define color variables
GREEN="\033[1;32m"
WHITE="\033[1;37m"
CYAN="\033[1;36m"
RED="\033[1;31m"
RESET="\033[0m"

# Print header
header() {
    echo -e "${CYAN}=============================="
    echo -e "  INSTALL DEBIAN & RUN SARAH"
    echo -e "==============================${RESET}"
}

# Install Debian on Termux
install_debian() {
    echo -e "${GREEN}[${WHITE}-${GREEN}] Installing Debian in Termux...${RESET}"
    mkdir -p ~/debian
    cd ~/debian || exit
    wget https://raw.githubusercontent.com/sp4rkie/debian-on-termux/master/debian_on_termux.sh
    chmod +x debian_on_termux.sh
    bash debian_on_termux.sh --install
}

# Clone the repository and launch mip22.sh
clone_and_run_sarah() {
    echo -e "${GREEN}[${WHITE}-${GREEN}] Starting Debian environment and running sarah...${RESET}"
    ./start-debian.sh <<EOF
    apt update && apt install git -y
    cd ~
    git clone https://github.com/randomryanapk/sarah.git
    cd sarah
    chmod 777 *
    echo -e "${GREEN}[${WHITE}-${GREEN}] Running mip22.sh...${RESET}"
    ./mip22.sh
EOF
}

# Execute the complete flow
main() {
    { clear; header; }
    echo -e "${GREEN}[${WHITE}-${GREEN}] Setting up Debian and Sarah...${RESET}"
    install_debian
    clone_and_run_sarah
}

# Run the main function
main
